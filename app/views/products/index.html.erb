<div data-controller="filter">
  <div class="flex gap-2 mb-3">
    <input type="text" name="q" placeholder="Search..." data-filter-target="q" data-action="input->filter#debounced" class="border px-2 py-1 rounded w-64" value="<%= params[:q] %>" />
    <input type="number" name="min_level" placeholder="Min level" data-filter-target="minLevel" data-action="input->filter#debounced" class="border px-2 py-1 rounded w-32" value="<%= params[:min_level] %>" />
  </div>

  <turbo-frame id="products_list">
    <div class="divide-y">
      <% @products.each do |p| %>
        <div class="flex items-center gap-3 py-2">
          <div class="w-12 h-12 bg-gray-100 rounded overflow-hidden">
            <% if p.product_image.attached? %>
              <%= image_tag url_for(p.product_image), class: "w-full h-full object-cover" %>
            <% end %>
          </div>
          <div class="flex-1">
            <div class="font-medium"><%= p.name %></div>
            <div class="text-sm text-gray-600">Qty: <%= p.qty %></div>
          </div>
          <div class="text-xs text-gray-500">
            <% p.tags.limit(3).each do |t| %>
              <span class="px-2 py-0.5 bg-gray-100 rounded"><%= t.name %></span>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>

    <div class="mt-3">
      <%== pagy_nav(@pagy) %>
    </div>
  </turbo-frame>
</div>
